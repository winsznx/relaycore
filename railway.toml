# Railway Configuration for RelayCore
# Defines all services to deploy

[build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile.graphql"

[[services]]
name = "graphql-api"
source = "."

[services.build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile.graphql"

[services.deploy]
startCommand = "node dist/api/graphql-server.js"
healthcheckPath = "/health"
healthcheckTimeout = 100
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[[services]]
name = "indexers"
source = "."

[services.build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile.indexers"

[services.deploy]
startCommand = "node dist/init.js"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[[services]]
name = "mcp-server"
source = "./mcp-server"

[services.build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile.mcp"

[services.deploy]
startCommand = "node dist/index.js"
healthcheckPath = "/health"
healthcheckTimeout = 100
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
